<div class="container">
  @if (!register) {
    <form [formGroup]="RegisterForm" (ngSubmit)="submitForm()">
      <div class="register">
        <app-record [record]="record"></app-record>

        <div style="width: 100%; padding-inline-end: 20px">
          <h3>انشاء عضوية</h3>
          <div class="d-md-flex justify-content-between">
            <div class="formcontainer formWrapper">
              <div class="inputForm">
                <label for="name" class="mb-2">الاسم</label>
                <input formControlName="name" id="name" type="text" class="InValid" placeholder="الاسم" />
                <div *ngIf="RegisterForm.get('name')?.errors && RegisterForm.get('name')?.touched" class="alert alert-danger">
                  <p *ngIf="RegisterForm.get('name')?.getError('required')" class="m-0">الاسم مطلوب</p>
                </div>
              </div>
              <div class="inputForm">
                <label for="phone" class="mb-2">رقم الهاتف</label>
                <input formControlName="phone" id="phone" type="tel" class="" placeholder="رقم الهاتف" />
                <div *ngIf="RegisterForm.get('phone')?.errors && RegisterForm.get('phone')?.touched" class="alert alert-danger">
                  <p *ngIf="RegisterForm.get('phone')?.getError('required')" class="m-0">رقم الهاتف مطلوب</p>
                  <p *ngIf="RegisterForm.get('phone')?.getError('pattern')" class="m-0">رقم الهاتف غير صحيح</p>
                </div>
              </div>
              <div class="inputForm">
                <label for="company_name" class="mb-2">اسم الشركة</label>
                <input formControlName="company_name" id="company_name" type="text" class="" placeholder="اسم الشركة" />
              </div>
              <div class="inputForm">
                <label for="whats" class="mb-2">رقم الواتس</label>
                <input formControlName="whats" id="whats" type="tel" class="" placeholder="رقم الواتس" />
              </div>
              <div class="inputForm">
                <label for="email" class="mb-2">البريد الالكترونى</label>
                <input formControlName="email" id="email" type="text" class="" placeholder="البريد الالكترونى" />
                <div *ngIf="RegisterForm.get('email')?.errors && RegisterForm.get('email')?.touched" class="alert alert-danger">
                  <p *ngIf="RegisterForm.get('email')?.getError('email')" class="m-0">البريد الاكتروني غير صحيح</p>
                  <p *ngIf="RegisterForm.get('email')?.getError('required')" class="m-0">البريد الاكتروني مطلوب</p>
                </div>
              </div>
              <div class="inputForm">
                <label for="confirm_email" class="mb-2">تأكيد البريد الالكترونى</label>
                <input formControlName="confirm_email" id="confirm_email" type="text" class="" placeholder="تأكيد البريد الالكترونى" />
              </div>
              <div class="inputForm">
                <label for="tax_card_num" class="mb-2">البطاقة الضريبية</label>
                <input formControlName="tax_card_num" id="tax_card_num" type="text" class="" placeholder="البطاقة الضريبية" />
              </div>
              <div class="inputForm">
                <label for="commercial_register_num" class="mb-2">السجل التجاري</label>
                <input formControlName="commercial_register_num" id="commercial_register_num" type="text" class="" placeholder="السجل التجاري" />
              </div>
              <div class="inputForm">
                <label for="country_id" class="mb-2"> الدولة</label>
                <select formControlName="country_id" id="country_id" [ngModel]="'#choseCountry'">
                  <option selected value="#choseCountry" disabled>اخنر الدوله</option>
                  @for (item of countries; track $index) {
                    <option [value]="item.id">{{ item.short_name }}</option>
                  }
                </select>
                <div *ngIf="RegisterForm.get('country_id')?.errors && RegisterForm.get('country_id')?.touched" class="alert alert-danger">
                  <p *ngIf="RegisterForm.get('country_id')?.getError('required')" class="m-0">الدولة مطلوبة</p>
                </div>
              </div>
              <div class="inputForm">
                <label for="city_id" class="mb-2">المدينه</label>
                <select formControlName="city_id" id="city_id" [ngModel]="'#choseCity'">
                  <option selected value="#choseCity" disabled>اختر</option>
                  @for (item of cities; track $index) {
                    <option [value]="item.id">{{ item.short_name }}</option>
                  }
                </select>
                <div *ngIf="RegisterForm.get('city_id')?.errors && RegisterForm.get('city_id')?.touched" class="alert alert-danger">
                  <p *ngIf="RegisterForm.get('city_id')?.getError('required')" class="m-0">المدينه مطلوبة</p>
                </div>
              </div>
              <div class="inputForm">
                <label for="password" class="mb-2">كلمة المرور</label>
                <div class="PasswordInput">
                  <input formControlName="password" id="password" [type]="showPassword ? 'text' : 'password'" class="" placeholder="كلمة المرور" />
                  <button class="button-no-style" *ngIf="!showPassword" (click)="showPassword = true">
                    <i class="fa-solid fa-eye-slash"></i>
                  </button>
                  <button class="button-no-style" *ngIf="showPassword" (click)="showPassword = false">
                    <i class="fa-regular fa-eye"></i>
                  </button>
                </div>
                <div *ngIf="RegisterForm.get('password')?.errors && RegisterForm.get('password')?.touched" class="alert alert-danger">
                  <p *ngIf="RegisterForm.get('password')?.getError('pattern')" class="m-0">استخدم 8 أحرف أو أكثر مع مزيج من الحروف والأرقام والرموز</p>
                  <p *ngIf="RegisterForm.get('password')?.getError('required')" class="m-0">كلمة المرور مطلوبة</p>
                </div>
              </div>
              <div class="inputForm">
                <label for="password_confirmation" class="mb-2">تأكيد كلمة المرور</label>
                <div class="PasswordInput">
                  <input
                    formControlName="password_confirmation"
                    id="password_confirmation"
                    [type]="showConfirmPassword ? 'text' : 'password'"
                    class=""
                    placeholder="تأكيد كلمة المرور"
                  />
                  <button class="button-no-style" *ngIf="!showConfirmPassword" (click)="showConfirmPassword = true">
                    <i class="fa-solid fa-eye-slash"></i>
                  </button>
                  <button class="button-no-style" *ngIf="showConfirmPassword" (click)="showConfirmPassword = false">
                    <i class="fa-regular fa-eye"></i>
                  </button>
                </div>
                <div *ngIf="RegisterForm.get('password_confirmation')?.errors && RegisterForm.get('password_confirmation')?.touched" class="alert alert-danger">
                  <p *ngIf="RegisterForm.get('password_confirmation')?.getError('pattern')" class="m-0">استخدم 8 أحرف أو أكثر مع مزيج من الحروف والأرقام والرموز</p>
                  <p *ngIf="RegisterForm.get('password_confirmation')?.getError('required')" class="m-0">كلمة المرور مطلوبة</p>
                </div>
              </div>
            </div>
            <div class="verticalDivier"></div>
            <div class="horizontalDivider my-5"></div>
            <div class="formcontainer">
              <h3>التخصص</h3>
              <div class="search">
                <input type="text" class="searchInput px-5 form-control" placeholder="بحث" (keyup)="categroySearch($event)" />
                <i class="fa-solid fa-magnifying-glass"></i>
              </div>
              <div class="mt-3">
                @for (categ of category(); track categ.id; let i = $index) {
                  <app-button-with-close-icon [addText]="categ.name" (click)="removeCategoryFromlist(i)"></app-button-with-close-icon>
                }
              </div>
              <div class="mt-4">
                <ul class="list-unstyled px-0 specializeList">
                  @for (categoryList of categoryList | categorySearch: categorySearchKeyword; track categoryList.id; let i = $index) {
                    <li>
                      <button (click)="handleCategoryList(categoryList)" class="button-no-style">
                        {{ categoryList.name }}
                      </button>
                    </li>
                  }
                </ul>
              </div>
            </div>
          </div>

          <div class="text-center">
            @if (inValidForm) {
              <p class="alert alert-danger mt-3">يرجى ملء جميع حقول الإدخال واختيار تخصص</p>
            }
            <button class="createButton btn" type="submit" [disabled]="!RegisterForm.valid">انشاء عضوية</button>
            <div class="d-flex justify-content-center align-items-center mt-3">
              <p class="m-0">لديك حساب بالفعل ؟</p>
              <button [routerLink]="['/auth/login']" routerLinkActive="router-link-active" class="createAccount">تسجيل الدخول</button>
            </div>
          </div>
        </div>
      </div>
    </form>
  } @else {
    <div>
      <form (ngSubmit)="activationCode(f)" #f="ngForm">
        <div class="inputForm">
          <label for="phoneNumber" class="mb-2"> رقم الهاتف</label>
          <input disabled [ngModel]="RegisterForm.get('phone')?.value" name="phoneNumber" id="phoneNumber" type="text" class="" placeholder="رقم الهاتف " ngModel />
        </div>
        <div class="inputForm">
          <label for="checkCode" class="mb-2">كود التفعيل</label>
          <input name="code" id="phoneNumber" type="text" class="" placeholder="كود التفعيل" ngModel required="" />
          <div class="d-flex justify-content-between mt-3">
            <button class="btn btn-outline-info" (click)="handleResendCode()" [disabled]="!resendCode">إعادة إرسال الرمز مرة أخرى</button>
            <p>{{ timer() + 's' }}</p>
          </div>
        </div>
        <div class="text-center">
          <button class="createButton" [disabled]="!f.valid" type="submit">تأكيد</button>
        </div>
      </form>
    </div>
  }
</div>
